<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dhaka-local-bus-route</title>
  </head>
  <body>
    <input type="text" placeholder="from" id="from" />
    <br />
    <input type="text" placeholder="to" id="to" />
    <br />
    <button id="search">search route</button>
    <br />
    search result:
    <div style="display: inline" id="search-result"></div>
    <div>
      <h4></h4>
      <ul id="menu"></ul>
    </div>
    <mark></mark>
  </body>
  <script src="./data.js"></script>
  <script>
    document.getElementById("search").addEventListener("click", function () {
      let from = document.getElementById("from").value;
      let to = document.getElementById("to").value;
      document.getElementsByTagName("h4")[0].innerHTML = `${from} â‡„ ${to}`;
      document.getElementById("menu").innerHTML = "";

      function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
      }
      let rt = information.filter(
        (bus) =>
          bus.route.toLowerCase().includes(from.toLowerCase()) &&
          bus.route.toLowerCase().includes(to.toLowerCase())
      );

      // created pattern  to highlight the departure and destination as user inputs
      const wordToReplacePattern = () => {
        let wordToReplace = `${capitalizeFirstLetter(
          from
        )} ${capitalizeFirstLetter(to)}`;
        let splittedWords = wordToReplace.split(/\s/);
        let pattern = new RegExp(`(${splittedWords.join("|")})`, "g");
        return pattern;
      };

      document.getElementById("search-result").innerText = rt.length;

      // created <div> containing every filtered(as user searched)  bus information and puts those div elements in an array
      let buses = rt.map((bus) => {
        let div = document.createElement("div");
        let p = document.createElement("p");
        let li = document.createElement("li");
        p.textContent = bus.busName;
        li.innerHTML = bus.route.replaceAll(
          wordToReplacePattern(),
          (match) => `<mark> ${match}</mark> ` // highlighting searched places
        );

        div.appendChild(p);
        div.appendChild(li);
        div.style.backgroundColor = "lightgray";
        div.style.padding = "20px";
        div.style.margin = "20px";
        p.style.fontSize = "1.2rem";
        return div;
      });

      for (let index = 0; index < buses.length; index++) {
        document.getElementById("menu").appendChild(buses[index]);
      }

      console.log(buses);
    });
  </script>
</html>
